<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Source Code</title>

<script src="site_libs/header-attrs-2.7/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/sandstone.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>








<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-sm-12 col-md-4 col-lg-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-sm-12 col-md-8 col-lg-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Investigating California's COVID-19 Vaccination Efforts by Region and County</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Project Homepage</a>
</li>
<li>
  <a href="data.html">Data Sourcing and Processing</a>
</li>
<li>
  <a href="tables.html">Data Tables</a>
</li>
<li>
  <a href="sourcecode.html">Source Code</a>
</li>
<li>
  <a href="contact.html">Contact Information</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Source Code</h1>

</div>


<p><span class="math display">\[\\[.05in]\]</span></p>
<p>This section of the website provides the source code for both the homepage and tables page of this project. Comments for chunks of code are provided to give context and give purpose to the code.</p>
<p><span class="math display">\[\\[.1in]\]</span></p>
<div id="source-code-for-both" class="section level3">
<h3><u>Source Code for Both</u></h3>
<pre class="r"><code># Load Libraries and Sources
library(tidyverse)
library(plotly)
library(cowplot)
library(RCurl)
library(scales)
source(&quot;datawrangle.R&quot;)

## Load and Alter Data 
download1 &lt;- getURL(&quot;https://data.lacity.org/api/views/rpp7-mevy/rows.csv?accessType=DOWNLOAD&quot;)
vaxCA &lt;- read.csv(text = download1)

covidCA &lt;- read.csv(url(&quot;https://data.chhs.ca.gov/dataset/f333528b-4d38-4814-bebb-12db1f10f535/resource/046cdd2b-31e5-4d34-9ed3-b48cdbc4be7a/download/covid19cases_test.csv&quot;))

covidCA &lt;-
  covidCA %&gt;%
  mutate(county = area) # Make variable names the same between the two datasets

vaxCA &lt;-
  vaxCA %&gt;%
  mutate(date = as.Date(vaxCA$date, &quot;%m/%d/%Y&quot;)) # Make data variable same format

mergedCA &lt;- merge(vaxCA, covidCA, 
                  by = c(&quot;date&quot;,&quot;county&quot;),
                  all.x = TRUE)

mergedCA &lt;-
  mergedCA %&gt;%
  filter(date &gt;= as.Date(&quot;2020-12-15&quot;)) %&gt;% # Start date of vaccines
  filter(date &lt;= as.Date(&quot;2021-10-31&quot;)) %&gt;% # End date for consistency
  group_by(date, county) %&gt;% 
  summarise(across(c(total_doses,cumulative_total_doses,
                     pfizer_doses,cumulative_pfizer_doses,
                     moderna_doses,cumulative_moderna_doses,
                     jj_doses,cumulative_jj_doses,
                     partially_vaccinated,
                     total_partially_vaccinated,fully_vaccinated,
                     cumulative_fully_vaccinated,at_least_one_dose,
                     cumulative_at_least_one_dose,population,
                     cases,cumulative_cases,deaths,
                     cumulative_deaths,total_tests,
                     cumulative_total_tests,positive_tests,
                     cumulative_positive_tests), mean, .groups = date))

mergedCA &lt;-
  mergedCA %&gt;%
  mutate(dose_standard = (cumulative_total_doses/population),
         pfizer_perc = ((cumulative_pfizer_doses/cumulative_total_doses)*100),
         moderna_perc = ((cumulative_moderna_doses/cumulative_total_doses)*100),
         jj_perc = ((cumulative_jj_doses/cumulative_total_doses)*100),
         perc_vaccinated = (cumulative_fully_vaccinated/population)*100,
         perc_partial = (cumulative_at_least_one_dose/population)*100)

# Region categories for each county below

superior &lt;- c(&quot;Butte&quot;, &quot;Colusa&quot;, &quot;Del Norte&quot;, &quot;Glenn&quot;, &quot;Humboldt&quot;, &quot;Lake&quot;, &quot;Lassen&quot;, &quot;Mendocino&quot;, &quot;Modoc&quot;, &quot;Nevada&quot;, &quot;Plumas&quot;, &quot;Shasta&quot;, &quot;Sierra&quot;, &quot;Siskiyou&quot;, &quot;Tehama&quot;, &quot;Trinity&quot;)

central &lt;- c(&quot;Alpine&quot;, &quot;Amador&quot;, &quot;Calaveras&quot;, &quot;El Dorado&quot;, &quot;Fresno&quot;, &quot;Inyo&quot;, &quot;Kings&quot;, &quot;Madera&quot;, &quot;Mariposa&quot;, &quot;Merced&quot;, &quot;Mono&quot;, &quot;Placer&quot;, &quot;Sacramento&quot;, &quot;San Joaquin&quot;, &quot;Stanislaus&quot;, &quot;Sutter&quot;, &quot;Yuba&quot;, &quot;Tulare&quot;, &quot;Tuolumne&quot;, &quot;Yolo&quot;)

bay &lt;- c(&quot;Alameda&quot;, &quot;Contra Costa&quot;, &quot;Marin&quot;, &quot;Monterey&quot;, &quot;Napa&quot;, &quot;San Benito&quot;, &quot;San Francisco&quot;, &quot;San Mateo&quot;, &quot;Santa Clara&quot;, &quot;Santa Cruz&quot;, &quot;Solano&quot;, &quot;Sonoma&quot;)

southern &lt;- c(&quot;Imperial&quot;, &quot;Kern&quot;, &quot;Orange&quot;, &quot;Riverside&quot;, &quot;San Bernardino&quot;, &quot;San Diego&quot;, &quot;San Luis Obispo&quot;, &quot;Santa Barbara&quot;, &quot;Ventura&quot;, &quot;Los Angeles&quot;)

mergedCA &lt;- # Sort counties into their categories
  mergedCA %&gt;% 
  mutate(region = case_when(county %in% superior ~ &quot;Superior California&quot;,
                            county %in% central ~ &quot;Central California&quot;,
                            county %in% bay ~ &quot;Bay Area&quot;,
                            county %in% southern ~ &quot;Southern California&quot;))

mergedCA3 &lt;-
  mergedCA %&gt;%
  group_by(region,date) %&gt;%
  summarise(county = county,
            region = region,
            ave_moderna = ave(moderna_perc),
            ave_pfizer = ave(pfizer_perc),
            ave_jj = ave(jj_perc),
            moderna_perc = moderna_perc,
            pfizer_perc = pfizer_perc,
            jj_perc = jj_perc,
            moderna_doses = moderna_doses,
            pfizer_doses = pfizer_doses,
            jj_doses = jj_doses)

mergedCA3[is.na(mergedCA3)] = 0 # Some math is zero divided by zero; replace the errors

dataAge &lt;- datawrangle(&quot;Age Group&quot;) # Call on function to get data frame for age

dataRace &lt;- datawrangle(&quot;Race/Ethnicity&quot;) # Call on function to get data frame for race

dataRace[6,3] &lt;- 100.00 # Some data made some values above 100%; manual fix</code></pre>
</div>
<div id="homepage-source-code" class="section level3">
<h3><u>Homepage Source Code</u></h3>
<pre class="r"><code># Figure 1
fig1 &lt;- 
    mergedCA %&gt;%
    ggplot() + 
    geom_line(aes(x = date, 
                  y = cumulative_fully_vaccinated/population*100, 
                  color = county)) +
    labs(title = &quot;Percent Fully Vaccinated Since Roll-out by Region&quot;, x = &quot;Date&quot;, 
         y = &quot;&quot;, color = &quot;County&quot;) +
  facet_wrap(~region)

ggplotly(fig1) %&gt;% 
  layout(yaxis = list(title = &quot;&quot;), # below code fixes axis label and title overlap
             margin = list(l = 100), 
             annotations = c(list(text = &quot;Percent Fully Vaccinated (%)&quot;,
                                  x = -0.10,
                                  xref = &quot;paper&quot;,
                                  y = 0.5,
                                  showarrow = F,
                                  textangle = -90)))


# Figure 2
fig2 &lt;- 
  mergedCA %&gt;%
  ggplot(aes(group = region)) +
  geom_line(mapping = aes(x = date, y = total_doses, color = &quot;Doses Administered&quot;)) +
  geom_line(mapping = aes(x = date, y = cases, color = &quot;Case Count&quot;)) +
  geom_line(mapping = aes(x = date, y = deaths, color = &quot;Death Count&quot;)) +
  labs(title = &quot;Doses, Cases, and Deaths by Region&quot;, x = &quot;Date&quot;, y = &quot;&quot;) +
  scale_colour_manual(values = c(&quot;Doses Administered&quot;=&quot;#C78888&quot;, 
                                   &quot;Case Count&quot;=&quot;#88C7C2&quot;, 
                                   &quot;Death Count&quot;=&quot;#E7D366&quot;)) +
  facet_wrap(~region, scales = &quot;free_y&quot;, shrink = TRUE) +
  scale_y_continuous(labels = comma) +
  theme(legend.title = element_blank(), plot.title.position = &quot;middle&quot;)
  
ggplotly(fig2, tooltip = c(&quot;x&quot;, &quot;y&quot;)) %&gt;% 
  layout(yaxis = list(title = &quot;&quot;),
             margin = list(l = 100), 
             annotations = c(list(text = &quot;Count&quot;,
                                  x = -0.15,
                                  xref = &quot;paper&quot;,
                                  y = 0.5,
                                  showarrow = F,
                                  textangle = -90)))


# Figure 3
fig3 &lt;- 
  mergedCA3 %&gt;%
  ggplot(aes(group = region)) +
  geom_line(aes(x = date, y = ave_moderna, color = &quot;Moderna&quot;)) +
  geom_line(aes(x = date, y = ave_pfizer, color = &quot;Pfizer&quot;)) +
  geom_line(aes(x = date, y = ave_jj, color = &quot;J&amp;J&quot;)) +
  scale_colour_manual(values = c(&quot;Moderna&quot;=&quot;#C78888&quot;, 
                                   &quot;Pfizer&quot;=&quot;#88C7C2&quot;, 
                                   &quot;J&amp;J&quot;=&quot;#E7D366&quot;)) +
    labs(title = &quot;Vaccination Efforts by Company&quot;, 
         x = &quot;Date&quot;, y = &quot;&quot;, color = &quot;Company&quot;) +
    theme(legend.title = element_blank(), 
          axis.title.y = element_text(hjust = -1.5)) +
    facet_wrap(~region)

ggplotly(fig3, tooltip = c(&quot;x&quot;, &quot;y&quot;)) %&gt;% 
  layout(yaxis = list(title = &quot;&quot;),
             margin = list(l = 100), 
             annotations = c(list(
               text = &quot;Percent of Total Doses Administered (%)&quot;,
               x = -0.2,
               xref = &quot;paper&quot;,
               y = 0.5,
               showarrow = F,
               textangle = -90)))

# Figure 4

fig4palette &lt;- c(&quot;#8AA399&quot;,&quot;#7D84B2&quot;,&quot;#FD96A9&quot;,&quot;#FFC857&quot;) # custom palette

fig4 &lt;-
  dataAge %&gt;%
  ggplot(mapping = aes(x = demographic_value, y = region_fully_vax, 
                       fill = demographic_value)) +
  geom_bar(stat = &quot;identity&quot;) +
  labs(x = &quot;Age Group&quot;, y = &quot;&quot;, 
       title = &quot;Vaccination Efforts by Age Group&quot;, 
       fill = &quot;Age Group&quot;) +
  scale_fill_manual(values = fig4palette) +
  facet_wrap(~region)

ggplotly(fig4, tooltip = c(&quot;x&quot;, &quot;y&quot;)) %&gt;% 
  layout(yaxis = list(title = &quot;&quot;),
             margin = list(l = 100), 
             annotations = c(list(
               text = &quot;Percent Fully Vaccinated (%)&quot;,
               x = -0.1,
               xref = &quot;paper&quot;,
               y = 0.5,
               showarrow = F,
               textangle = -90)))


# Figure 5
fig5palette &lt;- c(&quot;#C78888&quot;, &quot;#88C7C2&quot;, &quot;#E7D366&quot;, &quot;#8AA399&quot;, 
                 &quot;#7D84B2&quot;, &quot;#FD96A9&quot;, &quot;#FAA04C&quot;)

fig5 &lt;-
  dataRace %&gt;%
  ggplot(mapping = aes(x = demographic_value, y = region_fully_vax, 
                       fill = demographic_value)) +
  geom_bar(stat=&quot;identity&quot;) +
  labs(x = &quot;Race/Ethnicity&quot;, y = &quot;&quot;, 
       title = &quot;Vaccination Efforts by Age&quot;, 
       fill = &quot;Race/Ethnicity&quot;) +
  scale_fill_manual(values = fig5palette) +
  theme(axis.text.x = element_blank()) +
  facet_wrap(~region)

ggplotly(fig5, tooltip = c(&quot;x&quot;, &quot;y&quot;)) %&gt;% 
  layout(yaxis = list(title = &quot;&quot;),
             margin = list(l = 100), 
             annotations = c(list(
               text = &quot;Percent Fully Vaccinated (%)&quot;,
               x = -0.2,
               xref = &quot;paper&quot;,
               y = 0.5,
               showarrow = F,
               textangle = -90)))</code></pre>
</div>
<div id="tables-source-code" class="section level3">
<h3><u>Tables Source Code</u></h3>
<pre class="r"><code># Table 1
mergedCA %&gt;% 
  filter(date == &quot;2021-10-31&quot;) %&gt;% # ensure desired date is displayed
  group_by(region) %&gt;%
  summarise(Fully_min = min(cumulative_fully_vaccinated/population)*100, 
            Fully_mean = mean(cumulative_fully_vaccinated/population)*100,
            Fully_max = max(cumulative_fully_vaccinated/population)*100,
            Fully_sd = sd(cumulative_fully_vaccinated/population)*100) %&gt;% 
  knitr::kable(col.names = c(&quot;Region&quot;,  # make table presentable with kable()
                             &quot;Min %&quot;, 
                             &quot;Mean %&quot;, 
                             &quot;Max %&quot;,
                             &quot;SD %&quot;), digits = 2, &quot;pipe&quot;, align = &quot;c&quot;)


# Table 2
mergedCA %&gt;% 
  group_by(region) %&gt;%
  summarise(Cases_min = min(cases), 
            Cases_mean = mean(cases),
            Cases_max = max(cases),
            Cases_sd = sd(cases),
            Deaths_min = min(deaths), 
            Deaths_mean = mean(deaths),
            Deaths_max = max(deaths),
            Deaths_sd = sd(deaths),
            Doses_min = min(total_doses), 
            Doses_mean = mean(total_doses),
            Doses_max = max(total_doses),
            Doses_sd = sd(total_doses)) %&gt;% 
  knitr::kable(col.names = c(&quot;Region&quot;, 
                             &quot;Min Cases&quot;, 
                             &quot;Mean Cases&quot;, 
                             &quot;Max Cases&quot;,
                             &quot;SD Cases&quot;,
                             &quot;Min Deaths&quot;, 
                             &quot;Mean Deaths&quot;, 
                             &quot;Max Deaths&quot;,
                             &quot;SD Deaths&quot;,
                             &quot;Min Doses&quot;, 
                             &quot;Mean Doses&quot;, 
                             &quot;Max Doses&quot;,
                             &quot;SD Doses&quot;), digits = 2, &quot;pipe&quot;, align = &quot;c&quot;)



# Table 3
mergedCA3 %&gt;% 
  group_by(region) %&gt;%
  summarise(JJ_min = min(jj_doses),
            JJ_mean= mean(jj_doses),
            JJ_max = max(jj_doses),
            JJ_sd = sd(jj_doses),
            JJ_cum = sum(jj_doses),
            Mod_min = min(moderna_doses),
            Mod_mean= mean(moderna_doses),
            Mod_max = max(moderna_doses),
            Mod_sd = sd(moderna_doses),
            Mod_cum = sum(moderna_doses),
            Pfi_min = min(pfizer_doses),
            Pfi_mean= mean(pfizer_doses),
            Pfi_max = max(pfizer_doses),
            Pfi_sd = sd(pfizer_doses),
            Pfi_cum = sum(pfizer_doses)) %&gt;% 
  knitr::kable(col.names = c(&quot;Region&quot;, 
                             &quot;Min J&amp;J&quot;, 
                             &quot;Mean J&amp;J&quot;, 
                             &quot;Max J&amp;J&quot;,
                             &quot;SD J&amp;J&quot;,
                             &quot;Cum. J&amp;J&quot;,
                             &quot;Min Mod.&quot;, 
                             &quot;Mean Mod.&quot;, 
                             &quot;Max Mod.&quot;,
                             &quot;SD Mod.&quot;,
                             &quot;Cum. Mod.&quot;,
                             &quot;Min Pfi.&quot;, 
                             &quot;Mean Pfi.&quot;, 
                             &quot;Max Pfi.&quot;,
                             &quot;SD Pfi.&quot;,
                             &quot;Cum. Pfi.&quot;), digits = 2, &quot;pipe&quot;, align = &quot;c&quot;)

# Table 4
dataAge2 &lt;- datawrangle2(&quot;Age Group&quot;)

dataAge2 %&gt;%
  group_by(region, demographic_value) %&gt;%
  summarise(Perc_min = min(perc_fully_vax),
            Perc_mean= mean(perc_fully_vax),
            Perc_max = max(perc_fully_vax),
            Perc_sd = sd(perc_fully_vax)) %&gt;% 
  knitr::kable(col.names = c(&quot;Region&quot;,
                             &quot;Demographic&quot;,
                             &quot;Min %&quot;, 
                             &quot;Mean %&quot;, 
                             &quot;Max %&quot;,
                             &quot;SD %&quot;), digits = 2, &quot;pipe&quot;, align = &quot;cccccc&quot;)


# Table 5
dataRace2 &lt;- datawrangle2(&quot;Race/Ethnicity&quot;)

dataRace2 %&gt;%
  filter(perc_fully_vax &lt; 100) %&gt;%
  group_by(region, demographic_value) %&gt;%
  summarise(Perc_min = min(perc_fully_vax),
            Perc_mean= mean(perc_fully_vax),
            Perc_max = max(perc_fully_vax),
            Perc_sd = sd(perc_fully_vax)) %&gt;% 
  knitr::kable(col.names = c(&quot;Region&quot;,
                             &quot;Demographic&quot;,
                             &quot;Min %&quot;, 
                             &quot;Mean %&quot;, 
                             &quot;Max %&quot;,
                             &quot;SD %&quot;), digits = 2, &quot;pipe&quot;, align = &quot;cccccc&quot;)</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
